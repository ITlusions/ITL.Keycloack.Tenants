keycloak:
  name: itlkc01-prd
  secretNamespace: itl-cnpg-clusters
  instances: 2

    # Init containers for custom setup (optional)
  initContainers:
    - name: theme-downloader
      image: busybox:1.37.0
      command:
        - sh
        - -c
      args:
        - |
          echo "Downloading Keycloak theme..."
          wget https://github.com/MinBZK/keycloak-theme/releases/download/v1.0.1/keycloak-nl-design-system.jar -O /opt/keycloak/providers/keycloak-nl-design-system.jar
          echo "Theme downloaded successfully"
      volumeMounts:
        - name: keycloak-providers
          mountPath: /opt/keycloak/providers/
      securityContext:
        runAsUser: 0
      resources:
        requests:
          memory: 64Mi
          cpu: 50m
        limits:
          memory: 128Mi
          cpu: 100m
  
  # Additional volumes for init containers (optional)
  additionalVolumes:
    - name: keycloak-providers
      emptyDir: {}
  
  # Additional volume mounts for main container (optional)
  additionalVolumeMounts:
    - name: keycloak-providers
      mountPath: /opt/keycloak/providers/
      readOnly: false

  db:
    vendor: postgres
    host: postgres-db
    usernameSecret:
      name: keycloak-db-secret
      key: username
    passwordSecret:
      name: keycloak-db-secret
      key: password

  http:
    tlsSecret: itlkc01-prd-tls

  hostname:
    hostname: sts.itlusions.com

  proxy:
    headers: xforwarded

  externalAccess:
    enabled: true

certificate:
  additionalDnsNames:
    - login.itlusions.com

# Database Configuration for this tenant
database:
  enabled: true
  instances: 3
  name: keycloak
  username: keycloak
  storage:
    size: 50Gi
    storageClass: ha-gen-lh
  resources:
    requests:
      memory: 1Gi
      cpu: 500m
    limits:
      memory: 4Gi
      cpu: 2000m
  monitoring:
    enabled: true

ingress:
  enabled: true
  className: "traefik"
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure  # Specify entry points
    ingressClassName: "traefik"
    #cert-manager.io/cluster-issuer: "letsencrypt-issuer"
  hosts:
    - host: sts.itlusions.com
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls:
    - secretName: itl-keycloak-tenants-itlkc01-prd-tls
      hosts:
        - sts.itlusions.com

